
# 输出
* ConstraintLayout详解
* 输入法生命周期InputMethodService（https://blog.csdn.net/u014653815/article/details/107695834）
* 输入法框架
* 输入法布局
* 如何升级Android 14（https://developer.android.com/about/versions/14/behavior-changes-14?hl=zh-cn）

# 学习
* 较为详细的学习了信通卫士输入法

# 难题
* 输入法太复杂了
* 攻坚-找到oppo预览图有问题（）
* 处理了1646个搜狗表情编码和unicode编码的映射关系。首先将xlsx文件导出为便于数据处理的csv格式，然后本来准备编写单元测试去处理csv，但单元测试无法加载so库的代码，于是写了个测试页面来处理相关逻辑。首先通过ai生成键盘26个字母按键与keyCode的对应关系方法，然后遍历每一行csv数据中的拼音数据，接着模拟人为打字，对候选词遍历一个字符一个字符的调用搜狗native方法获取候选词。但由于获取候选词方法不是同步的，控制什么时候该分析候选词中有没有表情unicode、什么时候该reset并输入下一个候选词等逻辑非常麻烦。好在搜狗支持一次性输入一个完整的拼音简化了这个过程。不过表情unicode并没有什么特征能方便的区分，试了一些方法后，我决定反向区分。由于是拼音输入法，候选词基本都是汉字，若候选词的unicode编码不在汉字编码区间内，且符合一些简单的表情unicode规律，则认为它是满足条件的。原本到这里就结束了，但由于获取候选词不是同步的，为了保证数据不错乱，还需要对整个流程做了时序控制，然后提前创建足够大的列表，每获取一个候选词都放到指定的位置，这样便保证了每解析出一个表情unicode都能保证正确的映射关系，即便有解析错误的情况，也不会影响其他数据。处理完所有数据后，把结果添加到csv文件中即可。最终找到了1623个映射关系，对另外23个逐一检查也确实没有表情候选词。最后对1623抽样调查了40个，发现数据都是正确的，成功完成任务。
* 通过systrace分析拍照功能的耗时，发现处理拍照数据、保存图片占总耗时的9成左右，拿华为mate60举例，获取预览图80ms，处理图片数据、保存图片1500ms，其他耗时基本可以忽略。一开始我选择研究处理拍照数据和保存图片逻辑，发现特别复杂而且不好调整，于是我转而思考为什原生相机拍照能做到秒拍呢？仔细观察发现它们大概是在点击拍照的时候捕获一张当前的预览图，通过一个动画展示在指定位置，若快速点击预览图，则会有一个模糊到清晰的过程，像是在加载图片一样。于是我提出假设，它们处理图片保存图片也是较为耗时的，不过它们没有让这个过程阻塞用户，故给人的感觉非常快。用同样的思路，最终将app拍照用户感知的速度降到了原来的1/20
* 


# 边界拓展
* 修改手写键盘样式时，发现和设计图细节相差挺多，于是对着设计图一一计算更正，最后视觉效果好多啦（之后可以和ui对一下，把各个键盘统一优化下）
* 评估并升级android 14
* 调查并修复了网页不能跳转问题
* 研究Window，成功将软键盘的布局延伸到状态栏，并仔细核对了每一种文件预览在键盘端和app内的样式差异，除了对齐UI外，还发现并修复了xbug：app内预览多图左右切换时，文件名称不跟随变化；app内多图预览导航栏颜色不协调；app内预览单图背景颜色错误；app内预览文件导航栏颜色不协调；
* 若一个用户没有悬浮窗权限，app在后台时，他人给他打电话后收不到提示，且若此时进去app，也收不到提示，只有当拨打者挂电话后才能收到未接通的提示
* 如果用户授予麦克风权限时，选择的是仅一次，那么在下一次他人打过来的时候会崩溃；如果用户主动关闭了麦克风权限，它人打过来的时候也会崩溃
* 收到推送没有悬浮通知
* 没有麦克风权限加密通话被叫，会崩溃展示不出电话页面；但没有摄像头权限不会崩溃，能展示界面并申请。
* 发现提示收到加密通话的通知类型设置的不对，本应是高优先级的通话类型，被设置成低优先级的其他通知
 * 加密弹框动画可以优化下
 * 问了后端，不清楚是阿里云还是天翼云返回的时间戳不带毫秒值，会导致获取ossToken时崩溃，现已做兼容性处理